#+title: JOB for Optimistic Order-Preserving Hash Join

As a part of our journey to create a new operator called OOHJ, we need to benchmark it using Join Order Benchmark.

* Getting started

** Clone the repository

#+begin_src shell
git clone https://github.com/johansolbakken/benchmark
#+end_src

** Download the data

#+begin_src shell
ruby download.rb
#+END_SRC

This will create a dataset folder.


** Start MySQL

First download the repo and build MySQL. Then you need to run MySQL. We use MTR which is mysqls testing script.

#+begin_src shell
cd build # build folder in root of mysql for example
./mysql-test/mtr --start
#+end_src

Then from the build folder we need build/bin/mysql in the config.yaml file.

After first time, use:

#+begin_src shell
cd build # build folder in root of mysql for example
./mysql-test/mtr --start-dirty
#+end_src

** Setup the database

Copy the config.yaml.example and fill in mysql path.

#+begin_src shell
ruby run_queries.rb --setup
#+end_src

This creates tables and indexes.

** Feed the data

#+begin_src shell
ruby run_queries.rb --feed
#+end_src

** Run SQL files

Run a query

#+begin_src shell
ruby run_queries.rb --run ./job/1a.sql
#+end_src

Run a query with explain/analyze.

#+begin_src shell
ruby run_queries.rb --run ./job/1a.sql --explain
#+end_src



* Cleanup

#+begin_src shell
ruby cleanup.rb
#+end_src
